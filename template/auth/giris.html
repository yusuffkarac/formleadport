{% extends 'auth/base.html' %}
{% load static %}

{% block title %}Anmelden – {{ firma.isim|default:"" }}{% endblock %}
{% block description %}Melden Sie sich bei {{ firma.isim|default:"unserem System" }} an, um fortzufahren.{% endblock %}

{% block content %}
<!-- Wrapper -->
<div class="w-lg-500px bg-body rounded shadow-sm p-10 p-lg-15 mx-auto" style="max-width: 90%; margin: 0 auto;">

  <!-- Firma Logo + İsim -->
  <div class="text-center mb-8">
    <h1 class="text-dark mb-0">Jetzt anmelden bei {{ firma.isim|default:"uns" }}</h1>
  </div>

  <!-- Form seviyesindeki genel hatalar -->
  {% if form.non_field_errors %}
    <div class="alert alert-danger d-flex align-items-center mb-6" role="alert">
      <span class="me-2">⚠️</span>
      <div>
        {% for e in form.non_field_errors %}
          {{ e }}{% if not forloop.last %}<br/>{% endif %}
        {% endfor %}
      </div>
    </div>
  {% endif %}

  {% include 'widgets/messages.html' %}

  <!-- Giriş Formu -->
  <form method="post" class="form w-100" novalidate id="kt_sign_in_form" action="">
    {% csrf_token %}

    <!-- Benutzername -->
    <div class="fv-row mb-8">
      <label for="id_username" class="form-label fs-6 fw-bold text-dark">Benutzername</label>
      <input id="id_username" name="username" type="text" autocomplete="username" required class="form-control form-control-lg form-control-solid {% if form.username.errors %}is-invalid{% endif %}" value="{{ form.username.value|default:'' }}">
      {% if form.username.errors %}
        <div class="invalid-feedback">
          {% for e in form.username.errors %}
            {{ e }}{% if not forloop.last %}<br/>{% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <!-- Passwort -->
    <div class="fv-row mb-6">
      <div class="d-flex flex-stack mb-2">
        <label for="id_password" class="form-label fw-bold text-dark fs-6 mb-0">Passwort</label>
        <a href="{% url 'sifremi_unuttum' %}" class="link-primary fs-6 fw-bold">Passwort vergessen?</a>
      </div>
      <input id="id_password" name="password" type="password" autocomplete="current-password" required class="form-control form-control-lg form-control-solid {% if form.password.errors %}is-invalid{% endif %}">
      {% if form.password.errors %}
        <div class="invalid-feedback">
          {% for e in form.password.errors %}
            {{ e }}{% if not forloop.last %}<br/>{% endif %}
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <!-- Angemeldet bleiben + next yönlendirme -->
    <div class="d-flex flex-stack mb-8">
      <label class="form-check form-check-custom form-check-solid">
        <input class="form-check-input" type="checkbox" name="remember">
        <span class="form-check-label">Angemeldet bleiben</span>
      </label>
      {% if request.GET.next %}
        <input type="hidden" name="next" value="{{ request.GET.next }}">
      {% endif %}
    </div>

    <!-- Submit butonu -->
    <div class="text-center">
        <button type="submit" id="kt_sign_in_submit" class="btn btn-lg btn-primary w-100 mb-5">
        <span class="indicator-label">Anmelden</span>
        </button> 
    </div>
  </form>
</div>
{% endblock %}